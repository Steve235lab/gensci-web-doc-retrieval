# 后台数据库设计

**王义成 2022/6/22**

---

## 表：user

|  列  | 类型 | 长度 | 主键
| :--: | :--: | :--: | :--: |
| uuid | int | 11 | √ 
| username | varchar | 64 |
| password | varchar | 64 |
| email | varchar | 128 |
| confirm_code | varchar | 64 |
| email_confirmed | varchar | 16 |
| permissions | varchar | 32 |

---

## 表：search_history

|  列  | 类型 | 长度 | 主键
| :--: | :--: | :--: | :--: |
| timestamp | int | 11 | √ 
| result_timestamp | int | 11 |
| keywords | varchar | 1024 |
| search_completed_flag | varchar | 16 |
| uuid | int | 11 |
| favourite_flag | varchar | 16 |
| raw_keywords | varchar | 512|

> timestamp：该条搜索记录创建时的时间戳，作为主键

> result_timestamp：创建该条搜索记录时会先查找所有已经存在的记录，对比 keywords 字段，若找到相同的记录，则将该新记录的 result_timestamp 字段设置为相同 keywords 字段的第一条记录的 timestamp 字段，这样该条新纪录就指向了一个已经存在的结果文件夹。正确情况下，所有具有相同 keywords 字段的数据应该具有相同的 result_timestamp 字段。 

> uuid：作为外键关联到表 User 的 uuid，表示该条 search_history 数据是某个用户创建的

> favourite_flag：用于表示该条记录是否被用户收藏

> raw_keywords：用户输入的原始搜索关键字，不包括筛选器信息，用于前端页面的简洁显示。

---

## 表：paper_abstract

|  列  | 类型 | 长度 | 主键
| :--: | :--: | :--: | :--: |
| pmid | int | 11 | √ 
| highlight_abstract | longtext | -- |

> 用于存放文章的高亮处理后的摘要，相同PMID的文章（即同一篇文章）共用一行。


