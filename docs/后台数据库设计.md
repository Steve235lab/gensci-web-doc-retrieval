# 后台数据库设计

**王义成 2022/6/22**

---

## 表：user

|  列  | 类型 | 长度 | 主键
| :--: | :--: | :--: | :--: |
| uuid | int | 11 | √ 
| username | varchar | 64 |
| password | varchar | 64 |
| email | varchar | 128 |
| confirm_code | varchar | 64 |
| email_confirmed | varchar | 16 |
| permissions | varchar | 32 |

---

## 表：search_history

|  列  | 类型 | 长度 | 主键
| :--: | :--: | :--: | :--: |
| history_id | bigint | 19 | √ 
| result_path_id | bigint | 19 |
| raw_keywords | varchar | 256 |
| search_completed_flag | int | 11 |
| uuid | int | 11 |
| favourite_flag | int | 11 |
| start_time | varchar | 16 |
| end_time | varchar | 16 |
| filter_article_type | varchar | 128 |
| filter_age | set | -- |
| filter_language | set | -- |
| filter_species | set | -- |
| filter_sex | set | -- |

> history_id：自增主键。

> result_path_id：创建该条搜索记录时会先查找所有已经存在的记录，对比 raw_keywords及各filter 字段，若找到相同的记录，则将该新记录的 result_path_id 字段设置为相同 搜索关键词 的第一条记录的 history_id 字段，这样该条新纪录就指向了一个已经存在的结果文件夹。正确情况下，所有具有相同 搜索关键词 的数据应该具有相同的 result_path_id 字段。 

> uuid：作为外键关联到表 User 的 uuid，表示该条 search_history 数据是某个用户创建的

> favourite_flag：用于表示该条记录是否被用户收藏

> filter_age: set('0-18y','0-1m','0-23m','1-23m','2-5y','6-12y','13-18y','19+y','19-24y','19-44y','45+y','45-64y','65+y','80+y')

> filter_language: set('English','Others')

> filter_species: set('Humans','Other Animals')

> filter_sex: set('Female','Male')



